!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SPAMonitor=t():e.SPAMonitor=t()}(this,function(){return function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t._detail=t.cgi=t.click=t.report=void 0;var r=o(1),i=o(3),a=n(i),u=o(5),c=n(u),s=o(6),l=n(s),d=o(2),f=n(d),p=t.report=a["default"],h=t.click=c["default"],v=t.cgi=l["default"],m=t._detail=f["default"];(0,r.recordUsage)(),t["default"]={report:p,click:h,cgi:v,_detail:m}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.recordUsage=t.report=void 0;var r=o(2),i=n(r),a=t.report=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],o=null;try{e&&(o=new Image,o.src="//pinghot.qq.com/pingd?dm=gdt.qq.com.hot&url="+location.href+"&tt=-&hottag="+e+"&hotx=9999&hoty=9999&rand="+Math.random(),t())}catch(n){}},u=t.recordUsage=function(){var e=3e3;setTimeout(function(){try{var e=i["default"].version.replace(/\./g,"v"),t=location.host||location.hostname||"",o="felibrary."+i["default"].name.toLowerCase()+"."+t.replace(/\./g,"_")+"__"+e,n=i["default"].name.toLowerCase()+"_"+e,r=!1;window.sessionStorage&&window.sessionStorage.getItem(n)&&(r=!0),r||a(o,function(){window.sessionStorage&&window.sessionStorage.setItem(n,1)})}catch(u){}},e)};t["default"]={report:a,recordUsage:u}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"spa-monitor",library:"SPAMonitor",version:"1.3.0",dependencies:{css:[],js:[]}};t["default"]=o},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=o(4),u=!!(navigator&&navigator.sendBeacon&&window.FormData),c=(0,a.guid)(),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),o=document.cookie.match(t),n="";return o&&o.length>2&&(n=unescape(o[2])),n},l=function(){var e=s("skey"),t=5381,o=0,n=0;for(n=e.length;o<n;++o)t+=(t<<5)+e.charCodeAt(o);return 2147483647&t},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=e;return o&&t&&(o+=o.indexOf("?")>-1?"&":"?",o+=t),o},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="",o="",n={},r=null;return o=e.type||"",n=e.data||{},o||(o="GET"),o=o.toUpperCase(),e.url=d(e.url,"g_tk="+l()),t=JSON.stringify(n),r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r.onreadystatechange=function(){var t=r.status,o="";if(4==r.readyState)if(t>=200&&t<300){if(e.success){o=r.responseText;try{JSON&&JSON.parse&&(o=JSON.parse(o))}catch(n){}e.success(o,r.responseXML)}}else e.error&&e.error(r.responseText,r.responseXML)},"GET"==o?(r.open("GET",d(e.url,t),!0),r.send(null)):"POST"==o&&(r.open("POST",e.url,!0),r.setRequestHeader("Content-Type","application/json"),r.send(t)),r},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={},o={},n="";t=e.data||{},e.url=d(e.url,"g_tk="+l()),o=new FormData;for(n in t)n&&o.append(n,"object"==i(t[n])?JSON.stringify(t[n]):t[n]);return navigator.sendBeacon(e.url,o)},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";"undefined"!=typeof console&&console.warn&&e&&console.warn(e)},v=function(){var e=void 0;return function(t){return t&&(e=t),e}}(),m=function(){function e(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(this,e),v()?v():(this.url=o.url||"//e.qq.com/ec/api.php?mod=monitor&act=rpttdbank&report_type=batch&post_format=json&unicode=true",this.reportQueen=[],this.timeout=o.timeout||5e3,this.timer=null,this.useSendBeacon=o.useSendBeacon||!1,window.onbeforeunload=function(){t.report()},void v(this))}return r(e,[{key:"add",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&(this.reportQueen.push(t),this.reportQueen.length>=20?(window.clearTimeout(this.timer),this.report()):this.timer||(this.timer=setTimeout(function(){e.report()},this.timeout)))}},{key:"report",value:function(){if(this.timer=null,!Array.isArray(this.reportQueen)||0===this.reportQueen.length)return!1;var e=this.reportQueen.map(function(e){return e.data}),t={url:this.url,type:"POST",data:e,success:function(){},error:function(){h("批量上报错误")}};this.useSendBeacon&&u?p(t):f(t),this.reportQueen=[]}}]),e}(),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=location.host||location.hostname||"",o=/e.qq.com$/i,n=(new Date).getTime(),r=e.batchReport||!1,i=e.batchReportConf||{},a={},s={},l=!1,d="";if(s={create_time:Math.floor(n/1e3),spent_time:0,invoice_id:0,req_url:"",error_code:"",req_body:"",rsp_body:"",action_flag:1,operate_type:0,rate:1},o.test(t)&&e.data){for(d in e.data)d&&(s[d]=e.data[d]);if(Math.random()>s.rate)return!1;if(s.action_flag)if(s.operate_type)if(s.invoice_id=s.invoice_id||c,a.data=s,a.type="POST",a.url=e.url||"//e.qq.com/ec/api.php?mod=monitor&act=rpttdbank&post_format=json&unicode=true",a.success=e.success||function(){},a.error=e.error||function(){},a.useSendBeacon=e.useSendBeacon,r===!0){i.useSendBeacon=a.useSendBeacon&&u;var v=new m(i);v.add(a)}else l=a.useSendBeacon&&u?p(a):f(a);else h("operate_type错误");else h("action_flag错误")}else h("域名不符合上报要求，需要在e.qq.com及其子域名下");return l};t["default"]=g},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,o="x"==e?t:3&t|8;return o.toString(16)})+"-"+(new Date).getTime()};t["default"]={guid:o}},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(3),i=n(r),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data||null,o={},n="";if(o={clickid:"",clicktype:"",clicksystem:"",clickresult:"",clickcontent:"",action_flag:1,operate_type:205},!t||!t.clickid)return!1;for(n in t)n&&(o[n]=t[n]);return e.data=o,(0,i["default"])(e)};t["default"]=a},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(3),i=n(r),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data||null,o={},n="",r=e;if(r=e,o={source:"",host:location.host||location.hostname||"",url:location.href||"",cgi:"",method:"",params:"",responsetext:"",cookie:"",ret:0,time:0,content:"",action_flag:1,operate_type:207},!t||!t.cgi)return!1;for(n in t)n&&(o[n]=t[n]);return r.data=o,(0,i["default"])(r)};t["default"]=a}])});